(this.webpackJsonpreversi=this.webpackJsonpreversi||[]).push([[0],{16:function(e,t,r){},18:function(e,t,r){},19:function(e,t,r){},20:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r(5),i=r.n(a),c=r(10),o=r.n(c),s=(r(16),r.p,r(6)),u=r(7),l=r.n(u),h=r(9),v=r(1),f=r(2),b=r(4),y=r(3),d=[{x:0,y:1},{x:1,y:1},{x:1,y:0},{x:1,y:-1},{x:0,y:-1},{x:-1,y:-1},{x:-1,y:0},{x:-1,y:1}],p=function(e,t,r,n){for(var a=t.x+r.x,i=t.y+r.y;a>=0&&a<8&&i>=0&&i<8&&n.handleCell(a,i,e[a][i]);a+=r.x,i+=r.y);},j=function(){function e(t){Object(v.a)(this,e),this.myColor=t,this.otherColor=t===S?g:S,this.hasOtherPieces=!1,this.endsWithEmptySpace=!1,this.endPoint=null}return Object(f.a)(e,[{key:"handleCell",value:function(e,t,r){return this.endPoint={x:e,y:t},r===this.otherColor?(this.hasOtherPieces=!0,!0):r!==this.myColor&&(null==r?(this.endsWithEmptySpace=!0,!1):void 0)}},{key:"isValidMove",value:function(){return this.hasOtherPieces&&this.endsWithEmptySpace}},{key:"getEndPoint",value:function(){return this.endPoint}}]),e}(),k=function(){function e(t){Object(v.a)(this,e),this.myColor=t,this.otherColor=t===S?g:S,this.flip=!1,this.piecesToFlip=[]}return Object(f.a)(e,[{key:"handleCell",value:function(e,t,r){return r===this.otherColor?(this.piecesToFlip.push({x:e,y:t}),!0):r===this.myColor?(this.flip=!0,!1):null!=r&&void 0}}]),e}(),m=(r(18),"available"),O=function(e){Object(b.a)(r,e);var t=Object(y.a)(r);function r(){return Object(v.a)(this,r),t.apply(this,arguments)}return Object(f.a)(r,[{key:"render",value:function(){return Object(n.jsx)("div",{children:Object(n.jsx)(x,{game:this.props.game})})}}]),r}(i.a.Component),x=function(e){Object(b.a)(r,e);var t=Object(y.a)(r);function r(){return Object(v.a)(this,r),t.apply(this,arguments)}return Object(f.a)(r,[{key:"handleClick",value:function(e,t){var r=this.props.game;!r.isGameFinished()&&r.getCurrentPlayer()===r.blackPlayer&&this.isLegalClick(r,e,t)&&r.blackPlayer.makeMove({x:e,y:t})}},{key:"isLegalClick",value:function(e,t,r){var n,a=Object(s.a)(T(e.blackPlayer,e.state.boardState));try{for(a.s();!(n=a.n()).done;){var i=n.value;if(i.x===t&&i.y===r)return!0}}catch(c){a.e(c)}finally{a.f()}return!1}},{key:"renderCell",value:function(e,t){var r,a=this,i=this.props.game;if(i.getCurrentPlayer()!==i.blackPlayer)r=i.state.boardState[e][t];else{var c,o=!1,u=T(i.blackPlayer,i.state.boardState),l=Object(s.a)(u);try{for(l.s();!(c=l.n()).done;){var h=c.value;if(h.x===e&&h.y===t){o=!0,r=m;break}}}catch(v){l.e(v)}finally{l.f()}o||(r=i.state.boardState[e][t])}return Object(n.jsx)(P,{value:r,onClick:function(){return a.handleClick(e,t)}},"".concat(e,"_").concat(t))}},{key:"renderRow",value:function(e){for(var t=[],r=0;r<this.props.game.state.boardState[e].length;r++)t.push(this.renderCell(e,r));return Object(n.jsx)("div",{className:"board-row",children:t},e)}},{key:"render",value:function(){var e,t=this.props.game,r=t.state,a=t.getCurrentPlayer()===t.blackPlayer?"black":"white";if(r.winner)e="tie"===r.winner?"Tie":"Winner: "+r.winner;else if(0!==r.consecutivePasses){var i=t.getCurrentPlayer()===t.blackPlayer?"white":"black";e="Player ".concat(i,": PASS, next player: ").concat(a)}else e="Next player: "+a;for(var c=[],o=0;o<r.boardState.length;o++)c.push(this.renderRow(o));return Object(n.jsxs)("div",{children:[Object(n.jsx)("div",{className:"status",children:e}),Object(n.jsx)("div",{className:"board",children:c})]})}}]),r}(i.a.Component);function P(e){var t;switch(e.value){case S:t="board-cell-white";break;case g:t="board-cell-black";break;case m:t="board-cell-available";break;default:t="board-cell"}return Object(n.jsx)("button",{className:t,onClick:e.onClick})}function C(e,t,r){var n=function(e){for(var t=Array(e.length),r=0;r<e.length;r++)t[r]=e[r].slice();return t}(e);n[r.x][r.y]=t;var a,i=Object(s.a)(d);try{for(i.s();!(a=i.n()).done;){var c=a.value,o=new k(t);if(p(e,r,c,o),o.flip){var u,l=Object(s.a)(o.piecesToFlip);try{for(l.s();!(u=l.n()).done;){var h=u.value;n[h.x][h.y]=t}}catch(v){l.e(v)}finally{l.f()}}}}catch(v){i.e(v)}finally{i.f()}return n}var g=!0,S=!1,w=function(e){Object(b.a)(r,e);var t=Object(y.a)(r);function r(e){var n;return Object(v.a)(this,r),(n=t.call(this,e)).blackPlayer=e.blackPlayer,n.whitePlayer=e.whitePlayer,n.state=r.getInitialState(),n.gameLoop(),n}return Object(f.a)(r,[{key:"getCurrentPlayer",value:function(){return this.state.turnCounter%2===0?this.blackPlayer:this.whitePlayer}},{key:"isGameFinished",value:function(){if(2===this.state.consecutivePasses)return!0;for(var e=0;e<8;e++)if(this.state.boardState[e].includes(null))return!1;return!0}},{key:"registerMove",value:function(e,t){this.setState((function(r){return{boardState:C(r.boardState,e.color,t),turnCounter:r.turnCounter+1,consecutivePasses:0}})),this.forceUpdate()}},{key:"pass",value:function(){var e=Object(h.a)(l.a.mark((function e(){var t=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){t.getCurrentPlayer();t.setState((function(e){return{turnCounter:e.turnCounter+1,consecutivePasses:e.consecutivePasses+1}})),t.forceUpdate(),setTimeout((function(){return e()}),2e3)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"gameLoop",value:function(){var e=Object(h.a)(l.a.mark((function e(){var t,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isGameFinished()){e.next=14;break}return t=this.getCurrentPlayer(),e.next=4,t.nextMove(this.state.boardState);case 4:if(r=e.sent,console.log(t,r),null!=r){e.next=11;break}return e.next=9,this.pass();case 9:e.next=12;break;case 11:this.registerMove(t,r);case 12:e.next=0;break;case 14:this.setState({consecutivePasses:0,winner:this.getWinner()});case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getWinner",value:function(){for(var e=0,t=0,r=0;r<8;r++)for(var n=0;n<8;n++)switch(this.state.boardState[r][n]){case S:e++;break;case g:t++}return e===t?"TIE":e>t?"WHITE":"BLACK"}},{key:"render",value:function(){return Object(n.jsx)(O,{game:this})}}],[{key:"getInitialState",value:function(){for(var e=[],t=0;t<8;t++)e[t]=Array(8).fill(null);return e[3][3]=g,e[4][4]=g,e[3][4]=S,e[4][3]=S,{boardState:e,turnCounter:0,consecutivePasses:0}}}]),r}(i.a.Component);function T(e,t){for(var r=[],n=0;n<8;n++)for(var a=0;a<8;a++)if(t[n][a]===e.color){var i,c=Object(s.a)(d);try{for(c.s();!(i=c.n()).done;){var o=i.value,u=new j(e.color);p(t,{x:n,y:a},o,u),u.isValidMove()&&r.push(u.getEndPoint())}}catch(l){c.e(l)}finally{c.f()}}return r}r(19);var F=function e(t){Object(v.a)(this,e),this.color=t},M=function(e){Object(b.a)(r,e);var t=Object(y.a)(r);function r(){return Object(v.a)(this,r),t.apply(this,arguments)}return Object(f.a)(r,[{key:"makeMove",value:function(e){this.resolvePromise(e)}},{key:"nextMove",value:function(e){var t=this;return 0===T(this,e).length?Promise.resolve(null):new Promise((function(e){t.resolvePromise=e}))}}]),r}(F),E=function(e){Object(b.a)(r,e);var t=Object(y.a)(r);function r(){return Object(v.a)(this,r),t.apply(this,arguments)}return r}(F),L=function(e){Object(b.a)(r,e);var t=Object(y.a)(r);function r(e){return Object(v.a)(this,r),t.call(this,(function(e,t){return function(e,t){for(var r=0,n=0;n<8;n++)for(var a=0;a<8;a++)t[n][a]===e&&r++;return r}(e,t)}),e,6)}return r}(function(e){Object(b.a)(r,e);var t=Object(y.a)(r);function r(e,n,a){var i;return Object(v.a)(this,r),(i=t.call(this,n)).heuristic=e,i.maxDepth=a,i}return Object(f.a)(r,[{key:"nextMove",value:function(e){var t=this.minmax(0,{boardState:e,value:null,move:null},this.color);return new Promise((function(e){setTimeout((function(){e(t.move)}),2e3)}))}},{key:"minmax",value:function(e,t,r){if(e===this.maxDepth||this.isTerminalState(t))return t.value=this.heuristic(this.color,t.boardState),t;var n,a=r===S?-1:1/0,i=null,c=null,o=Object(s.a)(T({color:r},t.boardState));try{for(o.s();!(n=o.n()).done;){var u=n.value,l=C(t.boardState,r,u),h=this.minmax(e+1,{boardState:l,value:null,move:u},!r);(r===S&&a<h.value||r===g&&a>h.value)&&(a=h.value,i=h,c=u)}}catch(v){o.e(v)}finally{o.f()}return null===i&&(i=t,a=this.heuristic(this.color,t.boardState)),i.value=a,i.move=c,i}},{key:"isTerminalState",value:function(e){for(var t=!1,r=0;r<8;r++){for(var n=0;n<8;n++)if(null==e.boardState[r][n]){t=!0;break}if(t)break}return!t}}]),r}(E));function W(){var e=new M(g),t=new L(S);return Object(n.jsx)("div",{className:"App",children:Object(n.jsx)(w,{blackPlayer:e,whitePlayer:t})})}var I=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,21)).then((function(t){var r=t.getCLS,n=t.getFID,a=t.getFCP,i=t.getLCP,c=t.getTTFB;r(e),n(e),a(e),i(e),c(e)}))};o.a.render(Object(n.jsx)(i.a.StrictMode,{children:Object(n.jsx)(W,{})}),document.getElementById("root")),I()}},[[20,1,2]]]);
//# sourceMappingURL=main.ccdbff29.chunk.js.map